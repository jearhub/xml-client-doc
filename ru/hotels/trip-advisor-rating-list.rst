Рейтинг TripAdvisor
###################

Описание XML схемы получения списка рейтингов TripAdvisor
=========================================================

Запрос на получение списка рейтингов формируется через URL (методом GET), передаются стандартные параметры аутентификации (login, checksum, timestamp)

XSD-схема ответа :

- :download:`www/xsd/dict/tripadvisor/RatingListResponse.xsd <../../themes/hotelbook/static/xsd/dict/tripadvisor/RatingListResponse.xsd>`

Запрос списка рейтингов TripAdvisor
-----------------------------------

Запрос формируется по пути: ``/xml/tripadvisor_rating_list``

Возможные параметры, кроме параметров аутентификации:

-  ``hotel_id`` - id отеля

Либо:

-  ``hotel_name`` - приблизительное имя отеля (для поиска по LIKE)
-  ``country`` - страна, в которой находится отель
-  ``city`` - город, в котором находится отель
-  ``from`` - наименьший id отеля, с которого следует начинать вывод данных
-  ``limit`` - максимальное количество результатов в ответе

Ответ на запрос списка рейтингов — RatingList
---------------------------------------------

::

        <?xml version="1.0" encoding="utf-8"?>
        <Response>
            <RatingList>
                <Hotel id="id_отеля" review_count="количество_отзывов" average_rating="средний_рейтинг" rating_url="адрес_картинки_для_обозначения_рейтинга" hotel_url="адрес_страницы_отеля_на_TripAdvisor" />
                ...
            </RatingList>
        </Response>

Элемент Response
----------------

Корневой элемент.

**Атрибуты:** нет.

**Дочерний элемент:**

+--------------+----------------+--------------------------------------+
| Имя          | Обязательный   | Описание                             |
+==============+================+======================================+
| RatingList   | Да             | Содержит список отелей и рейтингов   |
+--------------+----------------+--------------------------------------+

Элемент RatingList
------------------

Содержит список отелей и рейтингов

**Атрибуты:** нет.

**Дочерний элемент:**

+-------+--------------+--------------------------------+
| Имя   | Обязательный | Описание                       |
+=======+==============+================================+
| Hotel | Нет          | Отель и информация о рейтингах |
+-------+--------------+--------------------------------+

**Атрибуты:**

-  ``id`` - идентификатор отеля
-  ``review_count`` - количество отзывов
-  ``average_rating`` - средний рейтинг
-  ``rating_url`` - ссылка на фирменную картинку с рейтингом
-  ``hotel_url`` - ссылка на страницу отеля на TripAdvisor

Возможные ошибки
----------------

Помимо стандартных ошибок аутентификации, возможна ошибка, связанная с
попыткой получить рейтинги и/или отзывы TripAdvisor тогда, когда это
действие не разрешено правами для данного пользователя. В этом случае
будет возвращена следующая ошибка:

-  <Error>You have no ACL rights to use TripAdvisor API</Error>

