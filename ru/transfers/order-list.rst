Список заказов
##############

Описание XML схемы получения списка заказов
===========================================

XSD-схема запроса списка заказов:

-  ``www/xsd/OrderListRequest.xsd``

XSD-схема ответа на запрос списка заказов:

-  ``www/xsd/OrderListResponse.xsd``

Запрос списка заказов, OrderListRequest
---------------------------------------

Запрос формируется по пути: ``/xml/order_list``

::

    <?xml version="1.0" encoding="utf-8"?>
    <OrderListRequest>
        [<CheckInFrom>...</CheckInFrom>]
        [<CreatedFrom>...</CreatedFrom>]
        [<CreatedTo>...</CreatedTo>]
        [<ChangedFrom>...</ChangedFrom>]
        [<ChangedTo>...</ChangedTo>]
    </OrderListRequest>

Элемент OrderListRequest
------------------------

Корневой элемент.

**Атрибуты:** нет.

**Дочерние элементы:**

+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+
| Имя         | Тип                         | Обязательный | Описание                                                              |
+=============+=============================+==============+=======================================================================+
| CheckInFrom | Дата в формате "YYYY-MM-DD" | Нет          | Вернуть лишь те трансферы, дата заезда которых с этой даты            |
+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+
| CreatedFrom | Дата в формате "YYYY-MM-DD" | Нет          | Вернуть лишь те трансферы, дата создания которых С этой даты          |
+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+
| CreatedTo   | Дата в формате "YYYY-MM-DD" | Нет          | Вернуть лишь те трансферы, дата создания которых ДО этой даты         |
+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+
| ChangedFrom | Дата в формате "YYYY-MM-DD" | Нет          | Вернуть лишь те трансферы, в которых произошли изменения С этой даты  |
+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+
| ChangedTo   | Дата в формате "YYYY-MM-DD" | Нет          | Вернуть лишь те трансферы, в которых произошли изменения ДО этой даты |
+-------------+-----------------------------+--------------+-----------------------------------------------------------------------+

Ответ на запрос списка заказов, OrderListResponse
-------------------------------------------------

::

    <?xml version="1.0" encoding="utf-8"?>
    <OrderListResponse>
     [<Errors>
        <Error code="..." description="..."> - ошибки
      </Errors>]
      <OrderList>
        <Orders agent="..."> - список заказов (может быть много)
          <Order id="..." state="..." via_xml_gate="true|false"> - список элементов заказа (может быть несколько)
            <TransferItem id="..." state="...">
              <Date>...</Date>
              <Created>...</Created>
              <FromCity>...</FromCity>
              <ToCity>...</ToCity>
              <FromLocation>...</FromLocation>
              <ToLocation>...</ToLocation>
              <Description>...</Description>
              <Logs>
                  <Log>...</Log>
              </Logs>
            </TransferItem>
          </Order>
        </Orders>
      </OrderList>
    </OrderListResponse>

Элемент OrderListResponse
-------------------------

Корневой элемент.

**Атрибуты:** нет.

**Дочерние элементы:**

+-----------+-------------------------------------+--------------------------+
| Имя       | Обязательный                        | Описание                 |
+===========+=====================================+==========================+
| Errors    | Нет                                 | Список ошибок, если есть |
+-----------+-------------------------------------+--------------------------+
| OrderList | Нет (отсутствует, если есть ошибки) | Список найденных заказов |
+-----------+-------------------------------------+--------------------------+

Элемент Errors
--------------

Список ошибок, если таковые имеются.

**Атрибуты:** нет.

**Дочерние элементы:**

+-------+--------------+--------------------------------------+
| Имя   | Обязательный | Описание                             |
+=======+==============+======================================+
| Error | Да           | Описание ошибки.                     |
|       |              | Атрибуты:                            |
|       |              |                                      |
|       |              | -  ``code`` - код ошибки             |
|       |              | -  ``description`` - описание ошибки |
+-------+--------------+--------------------------------------+

Элемент OrderList
-----------------

Список найденных заказов.

**Атрибуты:** нет.

**Дочерние элементы:**

+----------+----------------+------------------------------------------------------------------+
| Имя      | Обязательный   | Описание                                                         |
+==========+================+==================================================================+
| Orders   | Да             | Найденные заказы (элементы Order), принадлежащие одному агенту   |
+----------+----------------+------------------------------------------------------------------+

Элемент Orders
--------------

Найденные заказы, принадлежащие одному агенту.

**Атрибуты:**

+---------+----------+----------------+--------------+
| Имя     | Тип      | Обязательный   | Описание     |
+=========+==========+================+==============+
| agent   | Строка   | Да             | Имя агента   |
+---------+----------+----------------+--------------+

**Дочерние элементы:**

+---------+----------------+---------------------------+
| Имя     | Обязательный   | Описание                  |
+=========+================+===========================+
| Order   | Да             | Список элементов заказа   |
+---------+----------------+---------------------------+

Элемент Orders/Order
--------------------

Содержит cписок элементов заказа.

**Атрибуты:**

+--------------+----------------+--------------+----------------------------------------------+
| Имя          | Тип            | Обязательный | Описание                                     |
+==============+================+==============+==============================================+
| Id           | Число          | Да           | Идентификатор заказа                         |
+--------------+----------------+--------------+----------------------------------------------+
| state        | Строка         | Да           | Состояние заказа                             |
+--------------+----------------+--------------+----------------------------------------------+
| via_xm_lgate | true или false | Да           | Если true, заказ был добавлен через xml-шлюз |
+--------------+----------------+--------------+----------------------------------------------+

**Дочерние элементы:**

+--------------+--------------+---------------------------+
| Имя          | Обязательный | Описание                  |
+==============+==============+===========================+
| TransferItem | Да           | Описание трансфера заказа |
+--------------+--------------+---------------------------+

Элемент Orders/Order/TransferItem
---------------------------------

Описание элемента заказа.

**Атрибуты:**

+---------+----------+----------------+-----------------------------+
| Имя     | Тип      | Обязательный   | Описание                    |
+=========+==========+================+=============================+
| Id      | Число    | Да             | Идентификатор элемента      |
+---------+----------+----------------+-----------------------------+
| state   | Строка   | Да             | Состояние элемента заказа   |
+---------+----------+----------------+-----------------------------+

**Дочерние элементы:**

+--------------+-----------------------------+-----+--------------------+
| Date         | Дата в формате "YYYY-MM-DD" | Да  | Дата трансфера     |
+==============+=============================+=====+====================+
| Created      | Дата                        | Да  | Дата создания      |
+--------------+-----------------------------+-----+--------------------+
| FromCity     | Число                       | Да  | Город прибытия     |
+--------------+-----------------------------+-----+--------------------+
| ToCity       | Число                       | Да  | Город отбытия      |
+--------------+-----------------------------+-----+--------------------+
| FromLocation | Строка                      | Да  | Тип точки прибытия |
+--------------+-----------------------------+-----+--------------------+
| ToLocation   | Строка                      | Да  | Тип точки отбытия  |
+--------------+-----------------------------+-----+--------------------+
| Description  | Строка                      | Да  | Описание трансфера |
+--------------+-----------------------------+-----+--------------------+
| Logs         | Список элементов Log        | Нет | История            |
+--------------+-----------------------------+-----+--------------------+

Элемент Orders/Order/TransferItem/Logs
--------------------------------------

История элемента заказа.

**Атрибуты:** нет

**Дочерние элементы:**

+-----+--------+--------------+------------------------------------+
| Имя | Тип    | Обязательный | Описание                           |
+=====+========+==============+====================================+
| Log | Строка | Нет          | Запись истории (описание действия) |
+-----+--------+--------------+------------------------------------+

Элемент Orders/Order/TransferItem/Logs/Log
------------------------------------------

Запись истории элемента заказа.

**Атрибуты:**

+------+--------------+--------------+----------------------------------------------------------------------------------------------------+
| Имя  | Тип          | Обязательный | Описание                                                                                           |
+======+==============+==============+====================================================================================================+
| date | Дата и время | Да           | Дата и время действия, описанного в этой записи истории                                            |
+------+--------------+--------------+----------------------------------------------------------------------------------------------------+
| user | Строка       | Да           | Логин пользователя, совершившего описанное действие (или system, если действие совершено системой) |
+------+--------------+--------------+----------------------------------------------------------------------------------------------------+