Изменения заказа
################

Описание XML-схемы
==================

XSD-схема:

:download:`www/xsd/order/ModifyOrderRequest.xsd <../../themes/hotelbook/static/xsd/order/ModifyOrderRequest.xsd>`

:download:`www/xsd/order/ModifyOrderResponse.xsd <../../themes/hotelbook/static/xsd/order/ModifyOrderResponse.xsd>`

После того, как заказ создан, Вы можете модифицировать один или
несколько трансферов в созданном заказе. Для изменения заказа укажите id
заказа и список его элементов (с id элементов), которые Вы желаете
изменить. Вы можете указать дату, количество пассажиров, транспорт,
лидера, а также параметры мест прибытия и отправки. Все идентификаторы
(id заказа, элементов) можно получить в OrderInfoResponse

Обратите внимание, что конкретный трансфер может запрещать изменение
некоторых своих параметров (id аэропорта/станции/отеля в местах прибытия
или отправки). На это указывает параметр ModifyRestriction/FixFrom и
ModifyRestriction/FixTo для трансфера в OrderInfoResponse.

Запрос
------

XML-схема:

::


    <?xml version="1.0" encoding="utf-8"?>
    <ModifyOrderRequest>
      [<ContactInfo> - contact information
        <Name>..</Name> - имя
        <Email>..</Email> - email
        <Phone>..</Phone> - телефон
        <Comment>..</Comment> - комментарий
      </ContactInfo>]
      <OrderId>..</OrderId> - id заказа
      [<AccountComment>..</AccountComment>] - Комментарий для счета
      [<Partner>  - Контрагент
        [<PartnerId>...</PartnerId>] - номер контрагента
        [<PartnerBase>...</PartnerBase>] - номер базы контрагента
        [<PartnerName>...</PartnerName>] - имя клиента
      </Partner>] 
      [<PayForm>cash|cashless</PayForm>] - форма оплаты заказа (необязательно)
      <Items> - элементы заказа
        <TransferItem> - трансфер
            <Date>YYYY-MM-DD</Date> - дата трансфера
            <Passengers>...</Passengers> - количество пассажиров
            <VehicleId>...</VehicleId> - id транспорта
            <LeadingPax>
                 <Title>Mr|Mrs|Ms|Chld</Title> - обращение
                 <FirstName>..</FirstName> - имя (латинские)
                 <LastName>..</LastName> - фамилия (латинские)
                 [<Phone>..</Phone>] - телефон (для UTS Hotels)
            </LeadingPax>
            <PickUp>
                <AirportId>..</AirportId>
                <FlightNum>..</FlightNum>
                <ArrivalAirportId>..</ArrivalAirportId>
                <Time>..</Time>
                или
                <StationId>..</StationId>
                <TrainNum>..</TrainNum>
                <ArrivalCityId>..</ArrivalCityId>
                <Time>..</Time>
                или
                <HotelId>..</HotelId>
                <Time>..</Time>
                или
                <Address>
                   <AddressLine>..</AddressLine>
                   [<AddressLine>..</AddressLine>]
                </Address>
                <ZipCode>..</ZipCode>
                <District>..</District>
                <Phone>..</Phone>
                <Time>..</Time>
                или
                <ShipName>..</ShipName>
                <ShipCompanyName>..</ShipCompanyName>
                <ArrivalCity>..</ArrivalCity>
                <Time>..</Time>
            </PickUp>
            <DropOff>
                  <AirportId>..</AirportId>
                  <FlightNum>..</FlightNum>
                  <DepartureAirportId>..</ArrivalAirportId>
                  <Time>..</Time>
                  или
                  <StationId>..</StationId>
                  <TrainNum>..</TrainNum>
                  <DepartureCityId>..</ArrivalCityId>
                  <Time>..</Time>
                  или
                  <HotelId>..</HotelId>
                  или
                  <Address>
                     <AddressLine>..</AddressLine>
                     [<AddressLine>..</AddressLine>]
                  </Address>
                  <ZipCode>..</ZipCode>
                  <District>..</District>
                  <Phone>..</Phone>
                  или
                  <ShipName>..</ShipName>
                  <ShipCompanyName>..</ShipCompanyName>
                  <DepartureCity>..</ArrivalCity>
                  <Time>..</Time>
            </DropOff>
        </TransferItem>
      </Items>
    </ModifyOrderRequest>

Элемент ModifyOrderRequest
--------------------------

Родительский элемент.

- Атрибуты: нет.

Дочерние элементы:

+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| **Элемент**        | **Обязательный** | **Описание**            |                                            |                                                          |
+====================+==================+=========================+============================================+==========================================================+
| ``ContactInfo``    | нет              | контактная информация   |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | **Элемент**      | **Обязательный**        | **Описание**                               |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``Name``         | да                      | полное имя                                 |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``Email``        | да                      | электронная почта                          |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``Phone``        | да                      | телефон                                    |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``Comment``      | да                      | комментарий (может быть пустым)            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| ``OrderId``        | да               | id существующего заказа |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| ``AccountComment`` | нет              | Комментарий для счета   |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| ``Partner``        | нет              | Контрагент из ЮТС24     |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | **Элемент**      | **Обязательный**        | **Описание**                               |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``PartnerId``    | нет                     | Номер контрагента                          |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``PartnerBase``  | нет                     | Номер базы                                 |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``PartnerName``  | нет                     | Имя клиента                                |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| ``PayForm``        | нет              | Форма оплаты заказа     |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
| ``Items``          | да               | Элементы заказа         |                                            |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | **Элемент**      | **Обязательный**        | **Описание**                               |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    | ``TransferItem`` | да                      | Элемент заказа (может быть много в заказе) |                                                          |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | **Элемент**             | **Обязательный**                           | **Описание**                                             |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``ItemId``              | да                                         | Идентификатор элемента заказа                            |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``Date``                | нет                                        | Новая дата трансфера                                     |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``Passengers``          | нет                                        | Новое количество пассажиров                              |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``VehicleId``           | нет                                        | Идентификатор нового траспорта (/xml/transfer\_vehicles) |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``LeadingPax``          | нет                                        | Лидер трансфера (обращение, имя, фамилия)                |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``PickUp``              | нет                                        | Параметры места прибытия                                 |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+
|                    |                  | ``DropOff``             | нет                                        | Параметры места отбытия                                  |
+--------------------+------------------+-------------------------+--------------------------------------------+----------------------------------------------------------+

Элемент ContactInfo
-------------------

Атрибуты: нет.

Дочерние элементы:

+-------------+------------------+----------------------------------------------------+
| **Элемент** | **Обязательный** | **Описание**                                       |
+=============+==================+====================================================+
| ``Name``    | да               | Полное имя пользователя (максимально 100 символов) |
+-------------+------------------+----------------------------------------------------+
| ``Email``   | да               | электронный адрес (максимально 100 символов)       |
+-------------+------------------+----------------------------------------------------+
| ``Phone``   | да               | телефон (максимально 15 символов)                  |
+-------------+------------------+----------------------------------------------------+
| ``Comment`` | да               | комментарий (может быть пустым)                    |
+-------------+------------------+----------------------------------------------------+

Элемент Partner
---------------
Контрагент из ЮТС24
- *Необязательный элемент*
- *Аттрибутов нет.*

Дочерние элементы ``Partner``:

+-----------------+------------------+-------------------------------------------------+---------------------+
| **Элемент**     | **Обязательный** | **Описание**                                    | **Тип**             |
+=================+==================+=================================================+=====================+
| ``PartnerId``   | нет              | Номер контрагента.                              | Строка (8 символов) |
+-----------------+------------------+-------------------------------------------------+---------------------+
| ``PartnerBase`` | нет              | Номер базы контрагента.                         | Число               |
+-----------------+------------------+-------------------------------------------------+---------------------+
| ``PartnerName`` | нет              | Имя клиента                                     | Имя клиента         |
+-----------------+------------------+-------------------------------------------------+---------------------+

Элемент Items
-------------

Элементы заказа.

- Обязательный элемент.
- Атрибуты: нет.

Дочерние элементы:

+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
| **Элемент**      | **Обязательный** | **Описание**                               |                                                          |
+==================+==================+============================================+==========================================================+
| ``TransferItem`` | да               | Элемент заказа (может быть много в заказе) |                                                          |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | **Элемент**      | **Обязательный**                           | **Описание**                                             |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``ItemId``       | да                                         | Идентификатор элемента заказа                            |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``Date``         | нет                                        | Новая дата трансфера                                     |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``Passengers``   | нет                                        | Новое количество пассажиров                              |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``VehicleId``    | нет                                        | Идентификатор нового траспорта (/xml/transfer\_vehicles) |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``LeadingPax``   | нет                                        | Лидер трансфера (обращение, имя, фамилия)                |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``PickUp``       | нет                                        | Параметры места прибытия                                 |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+
|                  | ``DropOff``      | нет                                        | Параметры места отбытия                                  |
+------------------+------------------+--------------------------------------------+----------------------------------------------------------+

Элемент TransferItem
^^^^^^^^^^^^^^^^^^^^

Элемент заказа - трансфер.

- Обязательный элемент.
- Атрибуты: нет.

Дочерние элементы:

+----------------+------------------+----------------------------------------------------------+
| **Элемент**    | **Обязательный** | **Описание**                                             |
+================+==================+==========================================================+
| ``ItemId``     | да               | Идентификатор элемента заказа                            |
+----------------+------------------+----------------------------------------------------------+
| ``Date``       | нет              | Новая дата трансфера                                     |
+----------------+------------------+----------------------------------------------------------+
| ``Passengers`` | нет              | Новое количество пассажиров                              |
+----------------+------------------+----------------------------------------------------------+
| ``VehicleId``  | нет              | Идентификатор нового траспорта (/xml/transfer\_vehicles) |
+----------------+------------------+----------------------------------------------------------+
| ``LeadingPax`` | нет              | Лидер трансфера (обращение, имя, фамилия)                |
+----------------+------------------+----------------------------------------------------------+
| ``PickUp``     | нет              | Параметры места прибытия                                 |
+----------------+------------------+----------------------------------------------------------+
| ``DropOff``    | нет              | Параметры места отбытия                                  |
+----------------+------------------+----------------------------------------------------------+

Элемент LeadingPax
''''''''''''''''''

Новый лидер заказа.

- Обязательный элемент.
- Аттрибутов элемента нет.

Дочерние элементы:

+---------------+----------------+------------------+--------------------------------------+
| **Элемент**   | **Тип**        | **Обязательный** | **Описание**                         |
+===============+================+==================+======================================+
| ``Title``     | Mr,Ms,Mrs,Chld | да               | обращение                            |
+---------------+----------------+------------------+--------------------------------------+
| ``FirstName`` | строка         | да               | имя клиента (латинскими буквами)     |
+---------------+----------------+------------------+--------------------------------------+
| ``LastName``  | строка         | да               | фамилия клиента (латинскими буквами) |
+---------------+----------------+------------------+--------------------------------------+
| ``Phone``     | строка         | нет              | телефон (для поставщика UTS Hotels)  |
+---------------+----------------+------------------+--------------------------------------+

Элемент PickUp
''''''''''''''

Новые параметры места прибытия.

- Обязательный элемент.
- Аттрибутов элемента нет.
- Дочерние элементы (если тип точки - аэропорт):

+----------------------+---------+------------------+---------------------+
| **Элемент**          | **Тип** | **Обязательный** | **Описание**        |
+======================+=========+==================+=====================+
| ``AirportId``        | число   | нет              | id аэропорта        |
+----------------------+---------+------------------+---------------------+
| ``FlightNum``        | строка  | нет              | номер рейса         |
+----------------------+---------+------------------+---------------------+
| ``ArrivalAirportId`` | число   | нет              | id аэропорта вылета |
+----------------------+---------+------------------+---------------------+
| ``Time``             | HH:SS   | нет              | время прилета       |
+----------------------+---------+------------------+---------------------+

Дочерние элементы (если тип точки - станция):

+-------------------+---------+------------------+-------------------+
| **Элемент**       | **Тип** | **Обязательный** | **Описание**      |
+===================+=========+==================+===================+
| ``StationId``     | число   | нет              | id станции        |
+-------------------+---------+------------------+-------------------+
| ``TrainNum``      | строка  | нет              | номер поезда      |
+-------------------+---------+------------------+-------------------+
| ``ArrivalCityId`` | число   | нет              | id города отбытия |
+-------------------+---------+------------------+-------------------+
| ``Time``          | HH:SS   | нет              | время прибытия    |
+-------------------+---------+------------------+-------------------+

Дочерние элементы (если тип точки - отель):

+-------------+---------+------------------+---------------------+
| **Элемент** | **Тип** | **Обязательный** | **Описание**        |
+=============+=========+==================+=====================+
| ``HotelId`` | число   | нет              | id отеля            |
+-------------+---------+------------------+---------------------+
| ``Time``    | HH:SS   | нет              | время подачи машины |
+-------------+---------+------------------+---------------------+

Дочерние элементы (если тип точки - адрес):

+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| **Элемент**  | **Тип**                 | **Обязательный** | **Описание**                                                                                      |
+==============+=========================+==================+===================================================================================================+
| ``Address``  | вложенные элементы      | нет              | адрес в одной или двух строках (вложенные элементы ``AddressLine``), каждая длиной до 40 символов |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``ZipCode``  | строка (до 10 символов) | нет              | почтовый индекс                                                                                   |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``District`` | строка (до 20 символов) | нет              | название района                                                                                   |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``Phone``    | строка                  | нет              | номер телефона                                                                                    |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``Time``     | HH:SS                   | нет              | время подачи машины                                                                               |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+

Дочерние элементы (если тип точки - порт):

+---------------------+---------+------------------+-------------------------------+
| **Элемент**         | **Тип** | **Обязательный** | **Описание**                  |
+=====================+=========+==================+===============================+
| ``ShipName``        | строка  | нет              | название корабля              |
+---------------------+---------+------------------+-------------------------------+
| ``ShipCompanyName`` | строка  | нет              | название корабельной компании |
+---------------------+---------+------------------+-------------------------------+
| ``ArrivalCity``     | строка  | нет              | название города отбытия       |
+---------------------+---------+------------------+-------------------------------+
| ``Time``            | HH:SS   | нет              | время прибытия                |
+---------------------+---------+------------------+-------------------------------+

Элемент DropOff
'''''''''''''''

Параметры места отбытия.

- Обязательный элемент.
- Аттрибутов элемента нет.

Дочерние элементы (если тип точки - аэропорт):

+------------------------+---------+------------------+-------------------------+
| **Элемент**            | **Тип** | **Обязательный** | **Описание**            |
+========================+=========+==================+=========================+
| ``AirportId``          | число   | нет              | id аэропорта            |
+------------------------+---------+------------------+-------------------------+
| ``FlightNum``          | строка  | нет              | номер рейса             |
+------------------------+---------+------------------+-------------------------+
| ``DepartureAirportId`` | число   | нет              | id аэропорта назначения |
+------------------------+---------+------------------+-------------------------+
| ``Time``               | HH:SS   | нет              | время отлета            |
+------------------------+---------+------------------+-------------------------+

Дочерние элементы (если тип точки - станция):

+---------------------+---------+------------------+----------------------+
| **Элемент**         | **Тип** | **Обязательный** | **Описание**         |
+=====================+=========+==================+======================+
| ``StationId``       | число   | нет              | id станции           |
+---------------------+---------+------------------+----------------------+
| ``TrainNum``        | строка  | нет              | номер поезда         |
+---------------------+---------+------------------+----------------------+
| ``DepartureCityId`` | число   | нет              | id города назначения |
+---------------------+---------+------------------+----------------------+
| ``Time``            | HH:SS   | нет              | время отправки       |
+---------------------+---------+------------------+----------------------+

Дочерние элементы (если тип точки - отель):

+-------------+---------+------------------+--------------+
| **Элемент** | **Тип** | **Обязательный** | **Описание** |
+=============+=========+==================+==============+
| ``HotelId`` | число   | нет              | id отеля     |
+-------------+---------+------------------+--------------+

Дочерние элементы (если тип точки - адрес):

+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| **Элемент**  | **Тип**                 | **Обязательный** | **Описание**                                                                                      |
+==============+=========================+==================+===================================================================================================+
| ``Address``  | вложенные элементы      | нет              | адрес в одной или двух строках (вложенные элементы ``AddressLine``), каждая длиной до 40 символов |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``ZipCode``  | строка (до 10 символов) | нет              | почтовый индекс                                                                                   |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``District`` | строка (до 20 символов) | нет              | название района                                                                                   |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+
| ``Phone``    | строка                  | нет              | номер телефона                                                                                    |
+--------------+-------------------------+------------------+---------------------------------------------------------------------------------------------------+

Дочерние элементы (если тип точки - порт):

+---------------------+---------+------------------+-------------------------------+
| **Элемент**         | **Тип** | **Обязательный** | **Описание**                  |
+=====================+=========+==================+===============================+
| ``ShipName``        | строка  | нет              | название корабля              |
+---------------------+---------+------------------+-------------------------------+
| ``ShipCompanyName`` | строка  | нет              | название корабельной компании |
+---------------------+---------+------------------+-------------------------------+
| ``DepartureCity``   | строка  | нет              | название города назначения    |
+---------------------+---------+------------------+-------------------------------+
| ``Time``            | HH:SS   | нет              | время отправки                |
+---------------------+---------+------------------+-------------------------------+

Ответ, ModifyOrderResponse
--------------------------

Шаблон ответа такой же, как ответ на запрос информации о заказе (``OrderInfoResponse``).