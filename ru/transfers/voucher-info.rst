Информация для ваучера
######################

Описание XML схемы получения информации для ваучера
===================================================

Запрос на получение XML-описания ваучера сейчас формируется через URL (методом GET).

XSD-схема ответа информации для ваучера:

:download:`www/xsd/order/VoucherInfoResponse.xsd <../../themes/hotelbook/static/xsd/order/VoucherInfoResponse.xsd>`

Запрос информации для ваучера
-----------------------------

В запросе нужно указать идентификатор заказа ``?order_id=id_заказа``,
взятый из ответа на создание заказа, и идентификатор элемента заказа
``?item_id=id_элемента_заказа``, взятый из атрибута элемента
TransferItem из информации о заказе. Запрос формируется по пути: ``/xml/voucher_info``

Ответ на запрос информации для ваучера, VoucherInfoResponse
-----------------------------------------------------------

::

    <?xml version="1.0" encoding="utf-8"?>
    <VoucherInfoResponse>
      [<Errors><Error code="..." description="..."></Errors>]
      <Order Id="...">
        <ItemList>
          <Item Id="...">
            <VoucherAvailable>0|1</VoucherAvailable>
            <Voucher>
              <Issued>...</Issued>
              <BookingDetails>
                [<Supplier>...</Supplier>]
                [<Reference>...</Reference>]
                [<AdditionalDetailList>
                   <AdditionalDetail> - список дополнительных данных
                     <Title>...</Title>
                     <Value>...</Value>
                   </AdditionalDetail>
                 </AdditionalDetailList>]
              </BookingDetails>
              <Transfer>
                <Date>...</Date>
                <Name>...</Name>
                <Description>...</Description>
                <Language>...</Language>
                <LeadPassenger>...</LeadPassenger>
                <TotalPassengers>...</TotalPassengers>
                [<AdditionalDetailList>
                   <AdditionalDetail>
                     <Title>...</Title>
                     <Value>...</Value>
                   </AdditionalDetail>
                 </AdditionalDetailList>]
              </Transfer>
              <PickUp>
                  <LocationDetail>
                     <Title>...</Title>
                     <Value>...</Value>
                  </LocationDetail>
              </PickUp>
              <DropOff>
                  <LocationDetail>
                     <Title>...</Title>
                     <Value>...</Value>
                  </LocationDetail>
              </DropOff>
              [<AOTNumbers> - список контактов для экстренной связи
                 <Location name="...">...</Location>
               </AOTNumbers>]
              [<AdditionalInformation>...</AdditionalInformation>]
            </Voucher>
          </Item>
        </ItemList>
      </Order>
    </VoucherInfoResponse>

Элемент VoucherInfoResponse
---------------------------

Корневой элемент.

**Атрибуты:** нет.

**Дочерние элементы:**

+----------+---------------------------------------+----------------------------+
| Имя      | Обязательный                          | Описание                   |
+==========+=======================================+============================+
| Errors   | Нет                                   | Список ошибок, если есть   |
+----------+---------------------------------------+----------------------------+
| Order    | Нет (отсутствует, если есть ошибки)   | Описание заказа            |
+----------+---------------------------------------+----------------------------+

Элемент Errors
--------------

Смотри страницу :doc:`Ошибки <../errors>`

Элемент Order
-------------

Содержит описание заказа.

**Атрибуты:**

+-----+-------+--------------+----------------------+
| Имя | Тип   | Обязательный | Описание             |
+=====+=======+==============+======================+
| Id  | Число | Да           | Идентификатор заказа |
+-----+-------+--------------+----------------------+

 **Дочерние элементы:**

+----------+--------------+--------------------------------+
| Имя      | Обязательный | Описание                       |
+==========+==============+================================+
| ItemList | Да           | Список элементов заказа (Item) |
+----------+--------------+--------------------------------+

Элемент Order/ItemList
----------------------

Содержит список элементов заказа.

**Атрибуты:** нет.

**Дочерние элементы:**

+------+--------------+---------------------------+
| Имя  | Обязательный | Описание                  |
+======+==============+===========================+
| Item | Да           | Описание элемента заказа. |
+------+--------------+---------------------------+

Элемент Order/ItemList/Item
---------------------------

Содержит описание элемента заказа.

**Атрибуты:**

+-----+-------+--------------+-------------------------------+
| Имя | Тип   | Обязательный | Описание                      |
+=====+=======+==============+===============================+
| Id  | Число | Да           | Идентификатор элемента заказа |
+-----+-------+--------------+-------------------------------+

 **Дочерние элементы:**

+------------------+---------+--------------+------------------------------------------+
| Имя              | Тип     | Обязательный | Описание                                 |
+==================+=========+==============+==========================================+
| VoucherAvailable | 0 или 1 | Да           | Есть ли ваучер у элемента заказа         |
+------------------+---------+--------------+------------------------------------------+
| Voucher          | Строка  | Да           | Данные ваучера для этого элемента заказа |
+------------------+---------+--------------+------------------------------------------+

Элемент Order/ItemList/Item/Voucher
-----------------------------------

Данные ваучера для этого элемента заказа.

**Атрибуты:** нет.

**Дочерние элементы:**

+-----------------------+--------------+---------------------------------------+
| Имя                   | Обязательный | Описание                              |
+=======================+==============+=======================================+
| Issued                | Да           | Дата выпуска ваучера                  |
+-----------------------+--------------+---------------------------------------+
| BookingDetails        | Да           | Данные о бронировании                 |
+-----------------------+--------------+---------------------------------------+
| Transfer              | Да           | Описание трансфера                    |
+-----------------------+--------------+---------------------------------------+
| PickUp                | Да           | Описание места прибытия               |
+-----------------------+--------------+---------------------------------------+
| DropOff               | Да           | Описание места отправки               |
+-----------------------+--------------+---------------------------------------+
| AOTNumbers            | Нет          | Список контактов для экстренной связи |
+-----------------------+--------------+---------------------------------------+
| AdditionalInformation | Нет          | Дополнительная информация             |
+-----------------------+--------------+---------------------------------------+

Элемент Order/ItemList/Item/Voucher/BookingDetails
--------------------------------------------------

Данные о бронировании

**Атрибуты:** нет.

**Дочерние элементы:**

+----------------------+-----------------------------------+--------------+---------------------------------------------+
| Имя                  | Тип                               | Обязательный | Описание                                    |
+======================+===================================+==============+=============================================+
| Supplier             | Строка                            | Нет          | Название поставщика                         |
+----------------------+-----------------------------------+--------------+---------------------------------------------+
| Reference            | Строка                            | Нет          | Референс заказа                             |
+----------------------+-----------------------------------+--------------+---------------------------------------------+
| AdditionalDetailList | Список элементов AdditionalDetail | Нет          | Список дополнительных данных о бронировании |
+----------------------+-----------------------------------+--------------+---------------------------------------------+

Элемент Order/ItemList/Item/Voucher/BookingDetails/AdditionalDetailLists/AdditionalDetailList
---------------------------------------------------------------------------------------------

Список дополнительных данных

**Атрибуты:** нет.

**Дочерние элементы:**

+------------------+--------------+--------------------------------------------------+
| Имя              | Обязательный | Описание                                         |
+==================+==============+==================================================+
| AdditionalDetail | Нет          | Дополнительные данные - пара дочерних элементов: |
|                  |              |                                                  |
|                  |              | -  Title - название дополнительного параметра    |
|                  |              | -  Value - его значение                          |
+------------------+--------------+--------------------------------------------------+




Элемент Order/ItemList/Item/Voucher/Transfer
--------------------------------------------

Данные о трансфере, элементе заказа.

**Атрибуты:** 

+-------+----------------+---------------------------+
| Имя   | Обязательный   | Описание                  |
+=======+================+===========================+
| Id    | Да             | Идентификатор трансфера   |
+-------+----------------+---------------------------+

**Дочерние элементы:**

+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| Имя                  | Тип                               | Обязательный | Описание                                                                                                               |
+======================+===================================+==============+========================================================================================================================+
| Date                 | Строка                            | Да           | Дата трансфера (например, "12 December 2012")                                                                          |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| Name                 | Строка                            | Да           | Название трансфера                                                                                                     |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| Description          | Строка                            | Да           | Описание трансфера                                                                                                     |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| Language             | Строка                            | Да           | Язык трансфера                                                                                                         |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| LeadPassenger        | Строка                            | Да           | Клиент трансфера                                                                                                       |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| TotalPassengers      | Число                             | Да           | Общее количество пассажиров                                                                                            |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| AdditionalDetailList | Список элементов AdditionalDetail | Нет          | Список дополнительных данных о трансфере (структура аналогична структуре Voucher/BookingDetails/AdditionalDetailLists) |
+----------------------+-----------------------------------+--------------+------------------------------------------------------------------------------------------------------------------------+

Элемент Order/ItemList/Item/Voucher/PickUp
------------------------------------------

Данные (параметры) места прибытия

**Атрибуты:** нет.

**Дочерние элементы:**

+----------------+--------------+-------------------------------+
| Имя            | Обязательный | Описание                      |
+================+==============+===============================+
| LocationDetail | Нет          | пара дочерних элементов:      |
|                |              |                               |
|                |              | -  Title - название параметра |
|                |              | -  Value - его значение       |
+----------------+--------------+-------------------------------+

Элемент Order/ItemList/Item/Voucher/DropOff
-------------------------------------------

Данные (параметры) места отправки

**Атрибуты:** нет.

**Дочерние элементы:**

+----------------+--------------+-------------------------------+
| Имя            | Обязательный | Описание                      |
+================+==============+===============================+
| LocationDetail | Нет          | пара дочерних элементов:      |
|                |              |                               |
|                |              | -  Title - название параметра |
|                |              | -  Value - его значение       |
+----------------+--------------+-------------------------------+




Элемент Order/ItemList/Item/Voucher/AOTNumbers
----------------------------------------------

Список контактов для экстренной связи.

**Атрибуты:** нет.

**Дочерние элементы:**

+----------+--------+--------------+--------------------------------------------+
| Имя      | Тип    | Обязательный | Описание                                   |
+==========+========+==============+============================================+
| Location | Строка | Да           | Телефоны для города, заданного в атрибуте: |
|          |        |              |                                            |
|          |        |              | -  ``name`` - название города              |
+----------+--------+--------------+--------------------------------------------+